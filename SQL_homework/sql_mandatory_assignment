Zadání

1. Použijte schéma SCH_TEROR a tabulku TEROR (platí pro všechny úlohy).

Vypište vývoj po dnech (použijte pole IDAY, IMONTH, IYEAR a funkci DATE_FROM_PARTS) v roce 2015 v zemích Iraq, Nigeria a Syria. Tabulka by měla obsahovat stát, počet útoků (EVENTID), počet zabitých obětí (rozdíl NKILL a NKILLTER), počet zabitých teroristů a počet zraněných na daný den a danou zemi. Výsledek omezte pouze na dny, kdy bylo v dané zemi provedeno alespoň 10 útoků a počet obětí byl nejméně 8 (rozdíl NKILL a NKILLTER). Sloupečky rozumně přejmenujte (alias – AS), aby bylo poznat, jaká informace se v daném sloupečku nachází. Výsledek seřaďte podle země abecedně (A-Z) a zároveň vzestupně dle datumu. 

Pozn. správnost výpočtu si ověř třeba na počtech ze Sýrie.
 

2. Vypočítejte vzdálenost útoků od Prahy (latitude = 50.0755, longitude = 14.4378) a tuto hodnotu kategorizujte a spočítejte počet útoků (EVENTID) a počet obětí (rozdíl NKILL a NKILLTER). 

Kategorie: '0-99 km', '100-499 km', '500-999 km', '1000+ km', 'exact location unknown'. Berte v úvahu pouze roky 2014 a 2015. Seřaďte sestupně dle počtu útoků. Při kategorizaci dejte pozor, abyste skutečně pokryly všechny vzdálenosti a nestalo se vám, že na přelomu kategorií vám bude chybět jeden kilometr (nebo 1 metr 😊), např. hodnota 499,5 má spadat do kategorie '100-499 km' - je nežádoucí, aby spadla do 'exact location unknown'.


3. Zobrazte 15 útoků s největším počtem mrtvých (NKILL) ze zemí Iraq, Afghanistan, Pakistan, Nigeria. Z výsledku odfiltrujte targtype1_txt ‘Private Citizens & Property’, pro gname ‘Taliban’ tato výjimka neplatí (u této skupiny vypište i útoky s targtype1_txt ‘Private Citizens & Property’). Vypište pouze sloupečky eventid, iyear, country_txt, city, attacktype1_txt, targtype1_txt, gname, weaptype1_txt, nkill. Vyřešte bez použití UNION.